<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Controle Financeiro</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Controle Financeiro</h1>

  <!-- RESUMO (apenas 1!) -->
  <section class="card">
    <h2>Resumo</h2>
    <div id="resumo"></div>
  </section>

  <!-- NOVA TRANSAÇÃO -->
  <section class="card">
    <h2>Nova transação</h2>

    <form id="form">
      <div class="linha-form">
        <label>
          Origem
          <select id="origem" required>
            <option value="pix">PIX</option>
            <option value="debito">Débito</option>
            <option value="dinheiro">Dinheiro</option>
            <option value="cartao_credito">Cartão de crédito</option>
          </select>
        </label>

        <div id="areaCartao">
          <label>
            Cartão
            <select id="cartaoSelect"></select>
          </label>
          <label>
            Parcelas
            <input id="parcelasInput" type="number" min="1" max="48" value="1" />
          </label>
          <label>
            Juros mensal
            <input id="jurosInput" type="number" step="0.001" value="0" placeholder="ex: 0.02" />
          </label>
        </div>

        <input id="id" type="hidden" />

        <label>
          Descrição
          <input id="descricao" placeholder="ex: PS5 / Salário" required />
        </label>
        <label>
          Valor
          <input id="valor" type="number" step="0.01" min="0.01" placeholder="ex: 3500" required />
        </label>
        <label>
          Tipo
          <select id="tipo" required>
            <option value="entrada">Entrada</option>
            <option value="saida">Saída</option>
          </select>
        </label>
        <label>
          Categoria
          <select id="categoria"></select>
        </label>
        <label>
          Data
          <input id="data" type="date" required />
        </label>
        <button type="submit">Salvar</button>
      </div>
    </form>
  </section>

  <!-- RECORRÊNCIAS -->
  <section class="card">
    <h2>Recorrências</h2>
    <div id="resumoRec" style="margin:8px 0;"></div>

    <form id="formRec">
      <input id="r_id" type="hidden" />
      <input id="r_descricao" placeholder="Descrição (ex: Salário)" required />
      <input id="r_valor" type="number" step="0.01" min="0.01" placeholder="Valor" required />

      <select id="r_tipo" required>
        <option value="entrada">Entrada</option>
        <option value="saida">Saída</option>
      </select>

      <select id="r_categoria"></select>

      <input id="r_dia" type="number" min="1" max="28" placeholder="Dia (1-28)" required />

      <label style="display:flex; gap:6px; align-items:center;">
        <input id="r_ativo" type="checkbox" checked />
        Ativo
      </label>

      <button type="submit">Salvar recorrência</button>
    </form>

    <div style="margin-top:10px; display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
      <input id="r_mes" placeholder="YYYY-MM (ex: 2026-03)" />
      <button id="btnGerar" type="button">Gerar mês</button>
    </div>

    <table style="margin-top:10px;">
      <thead>
        <tr>
          <th>Dia</th><th>Descrição</th><th>Categoria</th><th>Tipo</th><th>Valor</th><th>Ativo</th><th>Ações</th><th>Origem</th>
        </tr>
      </thead>
      <tbody id="listaRec"></tbody>
    </table>
  </section>

<div style="margin-bottom:10px;">
  <label>Filtrar por mês:</label>
  <input type="month" id="filtroMes">
</div>

<section class="card">
  <h2>Relatório por categoria</h2>
  <table>
    <thead>
      <tr><th>Categoria</th><th>Saídas</th><th>Entradas</th></tr>
    </thead>
    <tbody id="relCats"></tbody>
  </table>
</section>
<section class="card">
  <h2>Gráfico por categoria</h2>
  <canvas id="chartCats" height="120"></canvas>
</section>

<section class="card">
  <h2>Previsão do mês</h2>
  <div id="previsao"></div>
</section>

<section class="card">
  <h2>Cartão de crédito</h2>

  <form id="formCartao">
    <input id="c_nome" placeholder="Nome do cartão" required />
    <input id="c_limite" type="number" step="0.01" placeholder="Limite" />
    <input id="c_fech" type="number" min="1" max="28" placeholder="Fechamento (1-28)" required />
    <input id="c_venc" type="number" min="1" max="28" placeholder="Vencimento (1-28)" required />
    <button type="submit">Criar cartão</button>
  </form>

  <hr/>
  
  <div style="margin-top:10px; display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
    <select id="fat_cartao"></select>
    <input type="month" id="fat_mes" />
    <button id="btnFat" type="button">Ver fatura</button>
  </div>

  <div id="fat_total" style="margin:10px 0;"></div>

  <table>
    <thead>
      <tr>
        <th>Parc</th><th>Descrição</th><th>Categoria</th><th>Mês</th><th>Valor</th><th>Status</th>
      </tr>
    </thead>
    <tbody id="fat_itens"></tbody>
  </table>
</section>

<!-- Chart.js (CDN) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- TRANSAÇÕES -->
  <section class="card">
    <h2>Transações</h2>
    <table>
      <thead>
        <tr>
          <th>Data</th><th>Descrição</th><th>Categoria</th><th>Tipo</th><th>Valor</th><th>Ações</th>
        </tr>
      </thead>
      <tbody id="lista"></tbody>
    </table>
  </section>

  <script src="app.js"></script>
</body>
</html>